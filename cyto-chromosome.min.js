!function(t,e){t.margin={top:35,left:14,right:5};var r=15,n=248956422,s=1217e5,i=function(){this._segment="1",this._domTarget=e.select(document.documentElement),this._resolution="550",this._width=1e3,this._svgHeight=75,this._useRelative=!0,this._showAxis=!1,this.dispatch=e.dispatch("bandclick","selectorchange"),this.rendered=!1,this.selectors=[]};i.prototype.segment=function(e){return"number"==typeof e&&(e=e.toString()),t.InitGetterSetter.call(this,"_segment",e)},i.prototype.target=function(r){if("string"==typeof r&&(r=e.select(r)),r.empty())throw"Error: Invalid dom target";return t.InitGetterSetter.call(this,"_domTarget",r)},i.prototype.resolution=function(e){return"number"==typeof e&&(e=e.toString()),t.InitGetterSetter.call(this,"_resolution",e)},i.prototype.width=function(e){return t.InitGetterSetter.call(this,"_width",e)},i.prototype.useRelative=function(e){return t.InitGetterSetter.call(this,"_useRelative",e)},i.prototype.showAxis=function(e){return t.InitGetterSetter.call(this,"_showAxis",e)},i.prototype.on=function(t,e){if(!this.dispatch.hasOwnProperty(t))throw"Error: No event for "+t;this.dispatch.on(t,e)},i.prototype.config=function(e,r){var n="_"+e;return t.InitGetterSetter.call(this,n,r)},i.prototype.renderAxis=function(){var n=e.svg.axis().scale(this.xscale).tickFormat(e.format("s")).orient("bottom");!this._useRelative||"Y"!==this._segment&&"22"!==this._segment&&"21"!==this._segment&&"20"!==this._segment&&"19"!==this._segment||n.ticks(6);var s=this.svgTarget.append("g").classed("bp-axis",!0).attr("transform","translate("+t.margin.left+","+(r+t.margin.top+5)+")");s.call(n),s.selectAll("text").style("font","10px sans-serif"),s.selectAll("path, line").style({fill:"none",stroke:"#666666","shape-rendering":"crispEdges"})},i.prototype.remove=function(){this.svgTarget.remove()},i.prototype.moveSelectorTo=function(t,e){if(2!==arguments.length)throw"Error moveSelectorTo: Invalid number of arguments. Both start and stop coordinates are required";0===this.selectors.length?this.newSelector(0,"10000000"):this.selectors[0].move(t,e)},i.prototype.newSelector=function(e,n){function s(t){var e=i.selectors.indexOf(t);i.selectors.splice(e,1)}var i=this,o=t.selector(s).x(t.margin.left).y(t.margin.top-r/4).height(r+r/2).xscale(this.xscale).extent([e,n]).target(this.svgTarget).render();o.dispatch.on("change",function(t){i.dispatch.selectorchange(t)}),this.selectors.push(o)},i.prototype.getSelections=function(){for(var t=[],e=0;e<this.selectors.length;e++){var r=this.selectors[e]._extent;t.push({start:r[0],stop:r[1]})}return t},i.prototype.render=function(){var i=this;return i.rendered&&i.remove(),t.modelLoader.load(this._segment,this._resolution,function(o){function a(e){var r=0;return i.alignCentromere&&"1"!==i._segment&&(r=i.xscale(s)-i.xscale(i.segMid)),i.xscale(e)+t.margin.left+r}var c=e.max(o,function(t){return+t.bp_stop});i.segMid=0;for(var l=0;l<o.length;l++)if("acen"===o[l].stain){i.segMid=o[l].bp_stop;break}var h=i._useRelative?c/n*i._width:i._width;i.xscale=e.scale.linear().domain([1,c]).range([0,h-t.margin.left]);var u=i.alignCentromere?i._width+.3*i._width:i._width;i.svgTarget=i._domTarget.append("svg").attr("width",u+t.margin.right).attr("height",i._svgHeight);var p=i.svgTarget.selectAll("g").data(o).enter();t.initPattern.call(i.svgTarget),i.svgTarget.append("text").text(i._segment).attr("x",5).attr("y",t.margin.top+r/2+2).attr("text-anchor","middle").style("font","10px sans-serif"),p.append("g").each(function(n,s){function c(){this.attr("stroke","#000000").attr("stroke-width",.2)}function l(e,n,s,i,o,c){return this.append("path").attr("d",t.roundedRect(a(e.bp_start),t.margin.top,a(e.bp_stop)-a(e.bp_start),r,n,s,i,o,c)).style("fill",t.getStainColour(e.stain,e.density))}var h=e.select(this);if(s%2===0){var u=(a(n.bp_stop)+a(n.bp_start))/2;h.append("line").attr("x1",u).attr("y1",t.margin.top).attr("x2",u).attr("y2",t.margin.top-4).style("stroke","grey").style("stroke-width",1),h.append("text").attr("transform","translate("+u+","+(t.margin.top-6)+")rotate(-50)").style("font","10px sans-serif").text(n.arm+n.band)}var p,d=a(n.bp_stop)-a(n.bp_start);if(0===s&&d>10)p=l.call(h,n,4,!0,!1,!0,!1),c.call(p);else if("acen"===n.stain&&d>6)"p"===n.arm?p=l.call(h,n,8,!1,!0,!1,!0):"q"===n.arm&&(p=l.call(h,n,8,!0,!1,!0,!1));else if(s===o.length-1)p=l.call(h,n,5,!1,!0,!1,!0),c.call(p);else{var g="stalk"===n.stain?t.margin.top+r/4:t.margin.top,f="stalk"===n.stain?r/2:r;p=h.append("rect").attr("x",a(n.bp_start)).attr("y",g).attr("height",f).attr("width",i.xscale(n.bp_stop)-i.xscale(n.bp_start)).style("fill",t.getStainColour(n.stain,n.density)),c.call(p)}p.append("title").text(n.arm+n.band),p.on("mouseover",function(r){var n=e.select(this).style("opacity","0.5").style("cursor","pointer");"gneg"===r.stain&&n.style("fill",t.getStainColour("gpos","25"))}),p.on("mouseout",function(r){var n=e.select(this).style("opacity","1").style("cursor","default");"gneg"===r.stain&&n.style("fill",t.getStainColour("gneg"))}),p.on("click",function(t){(0===i.selectors.length||e.event.shiftKey)&&i.newSelector(t.bp_start,t.bp_stop),i.dispatch.bandclick(t)})}),i._showAxis&&i.renderAxis(),i.rendered=!0}),i},t.chromosome=function(){return new i}}(window.cyto_chr=window.cyto_chr||{},d3),function(t,e){function r(){this.status="notloaded",this.cache=[]}function n(t,r,n){var s=c[r];if(0===s.cache.length){if("loading"===s.status)return void l.push({res:r,cb:n});"notloaded"===s.status&&(s.status="loading",e.tsv(t,function(t){for(s.cache=t,s.status="loaded",n(t);l.length>0;){var e=l.shift();e.cb(t)}}))}else n(s.cache)}function s(t,e,r){t=t||"1",e=e||"550";var s=o[e];n(a+s,e,function(e){var n=i(e,t);r(n)})}function i(t,e){for(var r=[],n=0;n<t.length;n++)t[n]["#chromosome"]===e&&r.push(t[n]);return r}var o={400:"ideogram_9606_GCF_000001305.14_400_V1",550:"ideogram_9606_GCF_000001305.14_550_V1",850:"ideogram_9606_GCF_000001305.14_850_V1",1200:"ideogram_9606_GCF_000001305.13_1200_v1"},a="data/",c={400:new r,550:new r,850:new r,1200:new r},l=[];t.modelLoader={load:s,setDataDir:function(t){a=t},getDataDir:function(){return a}}}(window.cyto_chr=window.cyto_chr||{},d3),function(t,e){var r=function(t){this._brush=e.svg.brush(),this.dispatch=e.dispatch("change"),this._x=0,this._y=0,this._extent=[0,0],this._height=0,this._closecb=t};r.prototype.test=function(e){var r=this;return t.InitGetterSetter.call(this,"_test",e,function(){r._another="_that"})},r.prototype.extent=function(e){var r=this;return t.InitGetterSetter.call(this,"_extent",e,function(){r._brush.extent(e)})},r.prototype.xscale=function(e){var r=this;return t.InitGetterSetter.call(this,"_xscale",e,function(){r._brush.x(e)})},r.prototype.target=function(e){return t.InitGetterSetter.call(this,"_target",e)},r.prototype.height=function(e){return t.InitGetterSetter.call(this,"_height",e)},r.prototype.x=function(e){return t.InitGetterSetter.call(this,"_x",e)},r.prototype.y=function(e){return t.InitGetterSetter.call(this,"_y",e)},r.prototype.render=function(){var r=this;this.selector=this._target.append("g").classed("selector",!0).attr("transform","translate("+this._x+","+this._y+")").call(this._brush),this.selector.selectAll("rect").attr("height",this._height),this.selector.select(".background").remove();var n=this.selector.select(".extent").style("fill","steelblue").style("opacity","0.5"),s=this._xscale(this._extent[1])+t.margin.left,i=t.margin.top-3,o=this._target.append("g");return o.append("title").text("remove"),this.deleteButton=o.append("circle").attr("cx",s).attr("cy",i).attr("r",5).attr("fill","red").on("mouseover",function(){e.select(this).style("cursor","pointer")}).on("mouseout",function(){e.select(this).style("cursor","default")}).on("click",function(){r.remove()}),this._brush.on("brush",function(){r.updateXButton(),r.dispatch.change(n)}),this},r.prototype.remove=function(){return this.selector.remove(),this.deleteButton.remove(),this._closecb(this),this},r.prototype.updateXButton=function(){var e=this._brush.extent(),r=this._xscale(e[1])+t.margin.left;this.deleteButton.attr("cx",r)},r.prototype.move=function(t,e){this._brush.extent([t,e]),this.selector.call(this._brush),this.updateXButton()},t.selector=function(t){return new r(t)}}(window.cyto_chr=window.cyto_chr||{},d3),function(t,e){t.initPattern=function(){var t=this.append("pattern").attr("id","acen-fill").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g").style({fill:"none",stroke:"#708090","stroke-width":"2"});t.append("path").attr("d","M0,0 l10,10"),t.append("path").attr("d","M10,0 l-10,10")},t.roundedRect=function(t,e,r,n,s,i,o,a,c){var l;return l="M"+(t+s)+","+e,l+="h"+(r-2*s),o?l+="a"+s+","+s+" 0 0 1 "+s+","+s:(l+="h"+s,l+="v"+s),l+="v"+(n-2*s),c?l+="a"+s+","+s+" 0 0 1 "+-s+","+s:(l+="v"+s,l+="h"+-s),l+="h"+(2*s-r),a?l+="a"+s+","+s+" 0 0 1 "+-s+","+-s:(l+="h"+-s,l+="v"+-s),l+="v"+(2*s-n),i?l+="a"+s+","+s+" 0 0 1 "+s+","+-s:(l+="v"+-s,l+="h"+s),l+="z"},t.getStainColour=function(t,e){if("gpos"==t){if(""===e||null===e)return"#000000";switch(e){case"100":return"#000000";case"75":return"#666666";case"50":return"#999999";case"25":return"#d9d9d9"}}return"gneg"===t?"#ffffff":"acen"===t?"url(#acen-fill)":"gvar"===t?"#e0e0e0":"stalk"===t?"#708090":"green"},t.setOption=function(t,e){return"undefined"!=typeof t?t:e},t.InitGetterSetter=function(t,e,r){return"undefined"!=typeof e?(this[t]=e,"function"==typeof r&&r(),this):this[t]}}(window.cyto_chr=window.cyto_chr||{},d3);