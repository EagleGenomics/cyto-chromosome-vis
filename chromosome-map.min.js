!function(t,e){t.margin={top:40,left:5};var r=17,n=248956422,s=1217e5,i=function(r){if("undefined"==typeof r.target)throw"Error: Chromosome constructor undfefined DOM target";if("undefined"==typeof r.segment)throw"Error: Chromosome segment is undfefined";this.domTarget="string"==typeof r.target?e.select(r.target):r.target,this.segment=r.segment.toString(),this.resolution=t.setOption(r.resolution,"550"),this.width=t.setOption(r.width,1e3),this.height=90,this.useRelative=t.setOption(r.useRelative,!0),this.showAxis=t.setOption(r.showAxis,!0),this.alignCentromere=t.setOption(r.alignCentromere,!1),this.dispatch=e.dispatch("bandclick","selectorchange")};i.prototype.on=function(t,e){if(!this.dispatch.hasOwnProperty(t))throw"Error: No event for "+t;this.dispatch.on(t,e)},i.prototype.renderAxis=function(){var n=e.svg.axis().scale(this.xscale).tickFormat(e.format("s")).orient("bottom");!this.useRelative||"Y"!==this.segment&&"22"!==this.segment&&"21"!==this.segment&&"20"!==this.segment&&"19"!==this.segment||n.ticks(6);var s=this.svgTarget.append("g").classed("bp-axis",!0).attr("transform","translate("+t.margin.left+","+(r+t.margin.top+5)+")");s.call(n),s.selectAll("text").style("font","10px sans-serif"),s.selectAll("path, line").style({fill:"none",stroke:"#666666","shape-rendering":"crispEdges"})},i.prototype.render=function(){var i=this;return t.modelLoader.load(this.segment,this.resolution,function(a){function o(e){var r=0;return i.alignCentromere&&"1"!==i.segment&&(console.log(i.segMid),r=i.xscale(s)-i.xscale(i.segMid)),i.xscale(e)+t.margin.left+r}var l=e.max(a,function(t){return+t.bp_stop});i.segMid=0;for(var c=0;c<a.length;c++)if("acen"===a[c].stain){i.segMid=a[c].bp_stop;break}var h=i.useRelative?l/n*i.width:i.width;i.xscale=e.scale.linear().domain([1,l]).range([0,h-t.margin.left]);var p=i.alignCentromere?i.width+.3*i.width:i.width;i.svgTarget=i.domTarget.append("svg").attr("width",p).attr("height",i.height);var u=i.svgTarget.selectAll("g").data(a).enter();u.append("g").each(function(n,s){function l(){this.attr("stroke","#000000").attr("stroke-width",.2)}function c(e,n,s,i,a,l){return this.append("path").attr("d",t.roundedRect(o(e.bp_start),t.margin.top,o(e.bp_stop)-o(e.bp_start),r,n,s,i,a,l)).style("fill",t.getStainColour(e.stain,e.density))}var h=e.select(this);if(s%2===0){var p=(o(n.bp_stop)+o(n.bp_start))/2;h.append("line").attr("x1",p).attr("y1",t.margin.top).attr("x2",p).attr("y2",t.margin.top-4).style("stroke","grey").style("stroke-width",1),h.append("text").attr("transform","translate("+p+","+(t.margin.top-6)+")rotate(-50)").style("font","10px sans-serif").text(n.arm+n.band)}var u,d=o(n.bp_stop)-o(n.bp_start);if(0===s&&d>10)u=c.call(h,n,4,!0,!1,!0,!1),l.call(u);else if("acen"===n.stain&&d>6)"p"===n.arm?u=c.call(h,n,8,!1,!0,!1,!0):"q"===n.arm&&(u=c.call(h,n,8,!0,!1,!0,!1));else if(s===a.length-1)u=c.call(h,n,5,!1,!0,!1,!0),l.call(u);else{var g="stalk"===n.stain?t.margin.top+r/4:t.margin.top,f="stalk"===n.stain?r/2:r;u=h.append("rect").attr("x",o(n.bp_start)).attr("y",g).attr("height",f).attr("width",i.xscale(n.bp_stop)-i.xscale(n.bp_start)).style("fill",t.getStainColour(n.stain,n.density)),l.call(u)}u.append("title").text(n.arm+n.band),u.on("mouseover",function(r){var n=e.select(this).style("opacity","0.5").style("cursor","pointer");"gneg"===r.stain&&n.style("fill",t.getStainColour("gpos","25"))}),u.on("mouseout",function(r){var n=e.select(this).style("opacity","1").style("cursor","default");"gneg"===r.stain&&n.style("fill",t.getStainColour("gneg"))}),u.on("click",function(e){var n=(new t.Selector).x(t.margin.left).y(t.margin.top-r/4).height(r+r/2).xscale(i.xscale).extent([e.bp_start,e.bp_stop]).target(i.svgTarget).render();n.dispatch.on("change",function(t){i.dispatch.selectorchange(t)}),i.dispatch.bandclick(e)})}),i.showAxis&&i.renderAxis()}),i},t.Chromosome=i}(window.chr_map=window.chr_map||{},d3),function(t,e){}(window.chr_map=window.chr_map||{},d3),function(t,e){function r(t,r,n){if(0===o[r].length){if(l)return void c.push(n);l=!0,e.tsv(t,function(t){for(o[r]=t,l=!0,n(t);c.length>0;){var e=c.shift();e(t)}})}else n(o[r])}function n(t,e,n){var o=i[e];r(a+o,e,function(e){var r=s(e,t);n(r)})}function s(t,e){for(var r=[],n=0;n<t.length;n++)t[n]["#chromosome"]===e&&r.push(t[n]);return r}var i={400:"ideogram_9606_GCF_000001305.14_400_V1",550:"ideogram_9606_GCF_000001305.14_550_V1",850:"ideogram_9606_GCF_000001305.14_850_V1",1200:"ideogram_9606_GCF_000001305.13_1200_v1"},a="data/",o={400:[],550:[],850:[],1200:[]},l=!1,c=[];t.modelLoader={load:n,setBaseDir:function(t){a=t}}}(window.chr_map=window.chr_map||{},d3),function(t,e){function r(t,e){return"undefined"!=typeof e?(this[t]=e,this):this[t]}var n=function(t){t&&(this.extent=t),this.brush=e.svg.brush(),this.dispatch=e.dispatch("change")};n.prototype.extent=function(t){return r.call(this,"extent",t),this.brush.extent(t),this},n.prototype.xscale=function(t){return r.call(this,"xscale",t),this.brush.x(this.xscale),this},n.prototype.target=function(t){return r.call(this,"target",t)},n.prototype.height=function(t){return r.call(this,"height",t)},n.prototype.x=function(t){return r.call(this,"x",t)},n.prototype.y=function(t){return r.call(this,"y",t)},n.prototype.render=function(){var r=this;this.selector=this.target.append("g").attr("transform","translate("+this.x+","+this.y+")").call(this.brush),this.selector.selectAll("rect").attr("height",this.height),this.selector.select(".background").remove();var n=(this.selector.select(".extent").style("fill","steelblue").style("opacity","0.5"),this.target.append("g"));return n.append("title").text("remove"),this.deleteButton=n.append("circle").attr("cx",this.xscale(this.extent[1])+5).attr("cy",t.margin.top-5).attr("r",5).attr("fill","red").on("mouseover",function(){e.select(this).style("cursor","pointer").style("opacity","0.7")}).on("mouseout",function(){e.select(this).style("cursor","default").style("opacity","1")}).on("click",function(){r.remove()}),this.brush.on("brush",function(t){var e=r.brush.extent();r.deleteButton.attr("cx",r.xscale(e[1])+5),r.dispatch.change(e)}),this},n.prototype.remove=function(){return this.selector.remove(),this.deleteButton.remove(),this},t.Selector=n}(window.chr_map=window.chr_map||{},d3),function(t,e){t.roundedRect=function(t,e,r,n,s,i,a,o,l){var c;return c="M"+(t+s)+","+e,c+="h"+(r-2*s),a?c+="a"+s+","+s+" 0 0 1 "+s+","+s:(c+="h"+s,c+="v"+s),c+="v"+(n-2*s),l?c+="a"+s+","+s+" 0 0 1 "+-s+","+s:(c+="v"+s,c+="h"+-s),c+="h"+(2*s-r),o?c+="a"+s+","+s+" 0 0 1 "+-s+","+-s:(c+="h"+-s,c+="v"+-s),c+="v"+(2*s-n),i?c+="a"+s+","+s+" 0 0 1 "+s+","+-s:(c+="v"+-s,c+="h"+s),c+="z"},t.getStainColour=function(t,e){if("gpos"==t){if(""===e||null===e)return"#000000";switch(e){case"100":return"#000000";case"75":return"#666666";case"50":return"#999999";case"25":return"#d9d9d9"}}return"gneg"===t?"#ffffff":"acen"===t?"url(#acen-fill)":"gvar"===t?"#e0e0e0":"stalk"===t?"#708090":"green"},t.setOption=function(t,e){return"undefined"!=typeof t?t:e}}(window.chr_map=window.chr_map||{},d3);